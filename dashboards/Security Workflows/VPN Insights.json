{
    "dashboards": [
        {
            "dashboard": {
                "name": "84a62531-ebbd-4c3d-b81f-9d16e764fb75",
                "displayName": "Corelight → Security Workflows → VPN Insights",
                "definition": {
                    "filters": [
                        {
                            "id": "GlobalTimeFilter",
                            "dataSource": "GLOBAL",
                            "filterOperatorAndFieldValues": [
                                {
                                    "filterOperator": "PAST",
                                    "fieldValues": [
                                        "1",
                                        "DAY"
                                    ]
                                }
                            ],
                            "displayName": "Global Time Filter",
                            "chartIds": [
                                "1fe77fe6-4fc3-4dfb-b8ed-331ee4f79cf8",
                                "f2d5bc8e-0f38-4f8a-9b27-48c6b0dbc658",
                                "96d4c412-8b64-48bb-8a9d-91bc04955834",
                                "62d8bec5-c2c9-41da-9024-c1a08716387f",
                                "81fbe454-2072-41d3-a1bb-43a8d3ebfa40",
                                "5f5468aa-314c-4e19-baf7-adac4c1a3f96",
                                "3d6e2632-df27-4fe4-9a5a-f6da726e06e2"
                            ],
                            "isStandardTimeRangeFilter": true,
                            "isStandardTimeRangeFilterEnabled": true
                        },
                        {
                            "id": "287c764f-5f47-48e0-8a46-6881be80634f",
                            "dataSource": "UDM",
                            "fieldPath": "observer.hostname",
                            "filterOperatorAndFieldValues": [
                                {
                                    "filterOperator": "EQUAL",
                                    "fieldValues": [
                                        ""
                                    ]
                                }
                            ],
                            "displayName": "Corelight Sensor",
                            "chartIds": [
                                "1fe77fe6-4fc3-4dfb-b8ed-331ee4f79cf8",
                                "f2d5bc8e-0f38-4f8a-9b27-48c6b0dbc658",
                                "96d4c412-8b64-48bb-8a9d-91bc04955834",
                                "62d8bec5-c2c9-41da-9024-c1a08716387f",
                                "81fbe454-2072-41d3-a1bb-43a8d3ebfa40",
                                "5f5468aa-314c-4e19-baf7-adac4c1a3f96",
                                "3d6e2632-df27-4fe4-9a5a-f6da726e06e2"
                            ]
                        }
                    ],
                    "charts": [
                        {
                            "dashboardChart": "3d6e2632-df27-4fe4-9a5a-f6da726e06e2",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 32,
                                "startY": 0,
                                "spanY": 25
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "287c764f-5f47-48e0-8a46-6881be80634f"
                            ]
                        },
                        {
                            "dashboardChart": "62d8bec5-c2c9-41da-9024-c1a08716387f",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 96,
                                "startY": 25,
                                "spanY": 26
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "287c764f-5f47-48e0-8a46-6881be80634f"
                            ]
                        },
                        {
                            "dashboardChart": "81fbe454-2072-41d3-a1bb-43a8d3ebfa40",
                            "chartLayout": {
                                "startX": 32,
                                "spanX": 32,
                                "startY": 0,
                                "spanY": 25
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "287c764f-5f47-48e0-8a46-6881be80634f"
                            ]
                        },
                        {
                            "dashboardChart": "5f5468aa-314c-4e19-baf7-adac4c1a3f96",
                            "chartLayout": {
                                "startX": 64,
                                "spanX": 32,
                                "startY": 0,
                                "spanY": 25
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "287c764f-5f47-48e0-8a46-6881be80634f"
                            ]
                        },
                        {
                            "dashboardChart": "96d4c412-8b64-48bb-8a9d-91bc04955834",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 96,
                                "startY": 103,
                                "spanY": 28
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "287c764f-5f47-48e0-8a46-6881be80634f"
                            ]
                        },
                        {
                            "dashboardChart": "1fe77fe6-4fc3-4dfb-b8ed-331ee4f79cf8",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 96,
                                "startY": 77,
                                "spanY": 26
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "287c764f-5f47-48e0-8a46-6881be80634f"
                            ]
                        },
                        {
                            "dashboardChart": "f2d5bc8e-0f38-4f8a-9b27-48c6b0dbc658",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 96,
                                "startY": 51,
                                "spanY": 26
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "287c764f-5f47-48e0-8a46-6881be80634f"
                            ]
                        }
                    ]
                },
                "type": "CUSTOM",
                "etag": "1597fbd97e5185a2d26b0d3517abbfe25b52b1077121c0ef3cf21e652e128261",
                "access": "DASHBOARD_PRIVATE"
            },
            "dashboardCharts": [
                {
                    "name": "1fe77fe6-4fc3-4dfb-b8ed-331ee4f79cf8",
                    "displayName": "VPN JA3 Finger Prints",
                    "chartDatasource": {
                        "dashboardQuery": "ac2a6c62-9e8e-4c1e-9efa-86e994c9e963",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "network.tls.client.ja3",
                                "header": "ja3"
                            },
                            {
                                "field": "network.tls.server.ja3s",
                                "header": "ja3s"
                            },
                            {
                                "field": "count",
                                "header": "Count"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "1e332558eee46607fcbd1604ec9e6ca97efa507d9646ca34cef27e94d4b82c25"
                },
                {
                    "name": "62d8bec5-c2c9-41da-9024-c1a08716387f",
                    "displayName": "Inferences Over Time",
                    "chartDatasource": {
                        "dashboardQuery": "7dd0e755-e913-4f0b-bbc5-5b5e9ae0a5ef",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesName": "NSP",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#eb730a"
                                },
                                "seriesUniqueValue": "NSP",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "RSI",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#eb730a"
                                },
                                "seriesUniqueValue": "RSI",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "COM",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#10a3b7"
                                },
                                "seriesUniqueValue": "COM",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "SK",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#d15f6b"
                                },
                                "seriesUniqueValue": "SK",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "RW",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#e51f8f"
                                },
                                "seriesUniqueValue": "RW",
                                "areaStyle": {}
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "CATEGORY",
                                "displayName": "Time"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE",
                                "displayName": "Count"
                            }
                        ],
                        "legends": [
                            {
                                "bottom": 12,
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "seriesColumn": [
                            "inference"
                        ],
                        "groupingType": "Stacked"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "fe94e3af5f5a2890108ffd2cd667efe7c0b272f5bc31481c6e96aab251aef649"
                },
                {
                    "name": "5f5468aa-314c-4e19-baf7-adac4c1a3f96",
                    "displayName": "VPN Type",
                    "chartDatasource": {
                        "dashboardQuery": "ef390c10-e16c-4077-87a7-854be7f53c0b",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "PIE",
                                "encode": {
                                    "value": "count",
                                    "itemName": "vpn_type"
                                },
                                "dataLabel": {},
                                "radius": [
                                    "0%",
                                    "70%"
                                ]
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "bottom": 12,
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "5199f3845f135ef789341ce441fc040081e501392458e8236daa3fef905398eb"
                },
                {
                    "name": "96d4c412-8b64-48bb-8a9d-91bc04955834",
                    "displayName": "VPN Inference Log Data",
                    "chartDatasource": {
                        "dashboardQuery": "068479ea-fbaa-4209-b0fc-53d45e90dcc1",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "time",
                                "header": "Time"
                            },
                            {
                                "field": "principal.ip",
                                "header": "Source IP"
                            },
                            {
                                "field": "target.ip",
                                "header": "Destination IP"
                            },
                            {
                                "field": "inferences",
                                "header": "Inferences"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "39d870dbf2acaf331f9293ae236090c66045943f0277b53510de9bfef81f5f29"
                },
                {
                    "name": "81fbe454-2072-41d3-a1bb-43a8d3ebfa40",
                    "displayName": "Top VPN Users",
                    "chartDatasource": {
                        "dashboardQuery": "08e6ce44-2800-445a-a8a6-f0b2191b9952",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "PIE",
                                "encode": {
                                    "value": "count",
                                    "itemName": "principal.ip"
                                },
                                "dataLabel": {},
                                "radius": [
                                    "0%",
                                    "70%"
                                ],
                                "itemStyle": {
                                    "color": "undefined"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "bottom": 12,
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "6fa86db235553bdf11f9892cbb26c017f83e210e1702d06284bcdfb3c71cd020"
                },
                {
                    "name": "f2d5bc8e-0f38-4f8a-9b27-48c6b0dbc658",
                    "displayName": "Largest Transfers Between Host Pairs Over VPN",
                    "chartDatasource": {
                        "dashboardQuery": "24fcd942-dc70-4bce-8b55-733d74517a01",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "principal.ip",
                                "header": "Source IP"
                            },
                            {
                                "field": "target.ip",
                                "header": "Destination IP"
                            },
                            {
                                "field": "target.port",
                                "header": "Destination Port"
                            },
                            {
                                "field": "protocol_string",
                                "header": "Protocol"
                            },
                            {
                                "field": "target.ip_geo_artifact.location.country_or_region",
                                "header": "Destination Country"
                            },
                            {
                                "field": "target.application",
                                "header": "Service"
                            },
                            {
                                "field": "resp_bytes_sum",
                                "header": "Sum of Destination Bytes"
                            },
                            {
                                "field": "orig_bytes_sum",
                                "header": "Sum of Source Bytes"
                            },
                            {
                                "field": "giga_bytes",
                                "header": "Gigabytes"
                            },
                            {
                                "field": "count",
                                "header": "Number of Connections"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "9f13e3898d9b2c4c89386156d0e290915aeefb1d9f35f41b139b0db2b71d0b48"
                },
                {
                    "name": "3d6e2632-df27-4fe4-9a5a-f6da726e06e2",
                    "displayName": "Inference Type",
                    "chartDatasource": {
                        "dashboardQuery": "ddc6b2f0-3ce3-47dd-9fae-60658d98abd1",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "PIE",
                                "encode": {
                                    "value": "count",
                                    "itemName": "about.labels.value"
                                },
                                "dataLabel": {},
                                "radius": [
                                    "0%",
                                    "70%"
                                ],
                                "itemStyle": {
                                    "color": "undefined"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "bottom": 12,
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "f61d4b658a10ab8edc0f999d68fd9b7a5c91358892aeaa0ca57e22e1c6f9e18e"
                }
            ],
            "dashboardQueries": [
                {
                    "name": "24fcd942-dc70-4bce-8b55-733d74517a01",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"vpn\"\r\ntarget.application= /^spicy/\r\n$inference=about.labels[\"inference\"]\r\n$vpn_type=about.labels[\"vpn_type\"]\r\n$inference!=\"\"\r\n$vpn_type!=\"\"\r\n$protocol_string=if(network.ip_protocol=88, \"EIGRP\",\r\nif(network.ip_protocol=50, \"ESP\",\r\nif(network.ip_protocol=97, \"ETHERIP\",\r\nif(network.ip_protocol=47, \"GRE\",\r\nif(network.ip_protocol=1, \"ICMP\",\r\nif(network.ip_protocol=58, \"ICMP6\",\r\nif(network.ip_protocol=2, \"IGMP\",\r\nif(network.ip_protocol=41, \"IP6IN4\",\r\nif(network.ip_protocol=103, \"PIM\",\r\nif(network.ip_protocol=132, \"SCTP\",\r\nif(network.ip_protocol=6, \"TCP\",\r\nif(network.ip_protocol=17, \"UDP\",\r\nif(network.ip_protocol=0, \"UNKNOWN_IP_PROTOCOL\",\r\nif(network.ip_protocol=112, \"VRRP\", \"UNKNOWN_IP_PROTOCOL\"))))))))))))))\r\nmatch:\r\n    principal.ip, target.ip, target.port, $protocol_string, target.ip_geo_artifact.location.country_or_region, target.application\r\noutcome:\r\n    $resp_bytes_sum=sum(network.received_bytes)\r\n    $orig_bytes_sum=sum(network.sent_bytes)\r\n    $giga_bytes=(sum(network.received_bytes) + sum(network.sent_bytes)) / (1024 * 1024 * 1024)\r\n    $count=count_distinct(metadata.id)\r\norder:\r\n    $giga_bytes desc \r\nlimit:\r\n    20",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "2dac6449b908548859665382fd8a4ec9d3a01b0022689e6d1a31ec75e749d365"
                },
                {
                    "name": "ddc6b2f0-3ce3-47dd-9fae-60658d98abd1",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"vpn\"\r\nabout.labels.key=\"inference\"\r\nabout.labels.value!=\"\"\r\nmatch:\r\n    about.labels.value\r\noutcome:\r\n    $count=count_distinct(metadata.id)\r\norder:\r\n    $count desc \r\nlimit:\r\n    50",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "593342f77bd404fbe1c15500989c847542f44799a675cbff689a822f681d8362"
                },
                {
                    "name": "ac2a6c62-9e8e-4c1e-9efa-86e994c9e963",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"vpn\"\r\n$inference=about.labels[\"inference\"]\r\n$vpn_type=about.labels[\"vpn_type\"]\r\n$inference!=\"\"\r\n$vpn_type!=\"\"\r\nnetwork.tls.client.ja3!=\"\"\r\nnetwork.tls.server.ja3s!=\"\"\r\nmatch:\r\n    network.tls.client.ja3, network.tls.server.ja3s\r\noutcome:\r\n    $count=count_distinct(metadata.id)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "d3536a47119ebed8ab2a8928fc24bedd63912605c736349c45c67b6be2cba63f"
                },
                {
                    "name": "7dd0e755-e913-4f0b-bbc5-5b5e9ae0a5ef",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"vpn\"\r\n$inference=about.labels[\"inference\"]\r\n$vpn_type=about.labels[\"vpn_type\"]\r\n$date_hour=timestamp.get_timestamp(metadata.event_timestamp.seconds, \"%Y-%m-%d : %H\")\r\n$inference!=\"\"\r\n$vpn_type!=\"\"\r\nmatch:\r\n    $date_hour, $inference\r\noutcome:\r\n    $count=count_distinct(metadata.id)\r\norder:\r\n    $date_hour asc",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "2d660fc896d34bf61414b15b993cbe643f38f0bf5bcd8153c9f79ac7becb0364"
                },
                {
                    "name": "ef390c10-e16c-4077-87a7-854be7f53c0b",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"vpn\"\r\n$inference=about.labels[\"inference\"]\r\n$vpn_type=about.labels[\"vpn_type\"]\r\n$inference!=\"\"\r\n$vpn_type!=\"\"\r\nmatch:\r\n    $vpn_type\r\noutcome:\r\n    $count=count_distinct(metadata.id)\r\norder:\r\n    $count desc\r\nlimit:\r\n    50",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "7a2fc494b5c966157bbcbef9e10bc248ee33dd7159b2da2bb6b63f7676f1db6e"
                },
                {
                    "name": "068479ea-fbaa-4209-b0fc-53d45e90dcc1",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"vpn\"\r\nabout.labels.key=\"inference\"\r\n$vpn_type=about.labels[\"vpn_type\"]\r\n$time=timestamp.get_timestamp(metadata.event_timestamp.seconds)\r\nabout.labels.value!=\"\"\r\n$vpn_type!=\"\"\r\nmatch:\r\n    $time, principal.ip, target.ip\r\noutcome:\r\n    $inferences=array_distinct(about.labels.value)\r\norder:\r\n    $time asc",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "665d1102d608dada2551cdb46da5c39378c2fde08209a6788014f950a4906a9c"
                },
                {
                    "name": "08e6ce44-2800-445a-a8a6-f0b2191b9952",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"vpn\"\r\n$inference=about.labels[\"inference\"]\r\n$vpn_type=about.labels[\"vpn_type\"]\r\n$inference!=\"\"\r\n$vpn_type!=\"\"\r\n$combined_fields=strings.concat(principal.ip, about.labels[\"vpn_type\"], target.location.country_or_region)\r\nmatch:\r\n    principal.ip\r\noutcome:\r\n    $count=count_distinct($combined_fields)\r\norder:\r\n    $count desc\r\nlimit:\r\n    20",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "db9f119f12400787bb8d28dcd0750d6cfbc6c09494a320db3098ce09c3ced3d2"
                }
            ]
        }
    ]
}