{
    "dashboards": [
        {
            "dashboard": {
                "name": "51f566b5-ee61-47ab-b47c-518a0fac5423",
                "displayName": "Corelight → Security Workflows → SSH Inferences Overview",
                "definition": {
                    "filters": [
                        {
                            "id": "GlobalTimeFilter",
                            "dataSource": "GLOBAL",
                            "filterOperatorAndFieldValues": [
                                {
                                    "filterOperator": "PAST",
                                    "fieldValues": [
                                        "1",
                                        "DAY"
                                    ]
                                }
                            ],
                            "displayName": "Global Time Filter",
                            "chartIds": [
                                "e1c6f231-079e-486f-8b00-24efe9eccefc",
                                "6b37186d-3900-4e71-b746-542fb04d1a6b",
                                "be466519-09d3-4c47-a381-2d9b5e001594",
                                "991865ba-69e6-4880-a7b2-c9e6da4647f6",
                                "a05c4b0c-08d2-4630-8d6f-137ab824246c",
                                "ca23f4f0-3396-4df6-ac5e-4f78a161ee07"
                            ],
                            "isStandardTimeRangeFilter": true,
                            "isStandardTimeRangeFilterEnabled": true
                        },
                        {
                            "id": "c3d5fc33-4da7-4119-8da7-94b7f5e34661",
                            "dataSource": "UDM",
                            "fieldPath": "security_result.summary",
                            "filterOperatorAndFieldValues": [
                                {
                                    "filterOperator": "EQUAL",
                                    "fieldValues": [
                                        ""
                                    ]
                                }
                            ],
                            "displayName": "SSH Inferences",
                            "chartIds": [
                                "e1c6f231-079e-486f-8b00-24efe9eccefc",
                                "6b37186d-3900-4e71-b746-542fb04d1a6b",
                                "be466519-09d3-4c47-a381-2d9b5e001594",
                                "a05c4b0c-08d2-4630-8d6f-137ab824246c",
                                "991865ba-69e6-4880-a7b2-c9e6da4647f6",
                                "ca23f4f0-3396-4df6-ac5e-4f78a161ee07"
                            ]
                        }
                    ],
                    "charts": [
                        {
                            "dashboardChart": "ca23f4f0-3396-4df6-ac5e-4f78a161ee07",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 0,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "c3d5fc33-4da7-4119-8da7-94b7f5e34661"
                            ]
                        },
                        {
                            "dashboardChart": "be466519-09d3-4c47-a381-2d9b5e001594",
                            "chartLayout": {
                                "startX": 48,
                                "spanX": 48,
                                "startY": 0,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "c3d5fc33-4da7-4119-8da7-94b7f5e34661"
                            ]
                        },
                        {
                            "dashboardChart": "991865ba-69e6-4880-a7b2-c9e6da4647f6",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 27,
                                "spanY": 21
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "c3d5fc33-4da7-4119-8da7-94b7f5e34661"
                            ]
                        },
                        {
                            "dashboardChart": "6b37186d-3900-4e71-b746-542fb04d1a6b",
                            "chartLayout": {
                                "startX": 48,
                                "spanX": 48,
                                "startY": 27,
                                "spanY": 21
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "c3d5fc33-4da7-4119-8da7-94b7f5e34661"
                            ]
                        },
                        {
                            "dashboardChart": "e1c6f231-079e-486f-8b00-24efe9eccefc",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 96,
                                "startY": 48,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "c3d5fc33-4da7-4119-8da7-94b7f5e34661"
                            ]
                        },
                        {
                            "dashboardChart": "a05c4b0c-08d2-4630-8d6f-137ab824246c",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 96,
                                "startY": 75,
                                "spanY": 28
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "c3d5fc33-4da7-4119-8da7-94b7f5e34661"
                            ]
                        }
                    ]
                },
                "type": "CUSTOM",
                "etag": "09452a2f9dc3f0407de808efb59860cd6260596a7331afb51da745d6d08d775b",
                "access": "DASHBOARD_PRIVATE"
            },
            "dashboardCharts": [
                {
                    "name": "991865ba-69e6-4880-a7b2-c9e6da4647f6",
                    "displayName": "HASSH Fingerprint Details",
                    "chartDatasource": {
                        "dashboardQuery": "e0563f4c-607b-4ddf-ba8f-64fa9d4a179f",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "principal_ip",
                                "header": "Source IP"
                            },
                            {
                                "field": "hassh",
                                "header": "HASSH Client"
                            },
                            {
                                "field": "target_ip",
                                "header": "Destination IP"
                            },
                            {
                                "field": "hassh_server",
                                "header": "HASSH Server"
                            },
                            {
                                "field": "count",
                                "header": "Total Events"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "1cd00c91cc1ee1217c305fe2e034ae640bd5dda540fa106ef8fccb848851e275"
                },
                {
                    "name": "be466519-09d3-4c47-a381-2d9b5e001594",
                    "displayName": "SSH Inferences Over Time",
                    "chartDatasource": {
                        "dashboardQuery": "0d30ffc7-6197-42eb-b09e-ec411aaf1b2e",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesName": "Other Scanning",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#009886"
                                },
                                "seriesUniqueValue": "Other Scanning",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Keystrokes",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#4aa207"
                                },
                                "seriesUniqueValue": "Keystrokes",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Client Trusted Server",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#d15f6b"
                                },
                                "seriesUniqueValue": "Client Trusted Server",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Client Untrusted Server",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#5350fb"
                                },
                                "seriesUniqueValue": "Client Untrusted Server",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Public Key Authentication",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#1a73e8"
                                },
                                "seriesUniqueValue": "Public Key Authentication",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Automated Interaction",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#eb730a"
                                },
                                "seriesUniqueValue": "Automated Interaction",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Small Client File Download",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#10a3b7"
                                },
                                "seriesUniqueValue": "Small Client File Download",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Large Client File Download",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#1a73e8"
                                },
                                "seriesUniqueValue": "Large Client File Download",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Interactive Password Authentication",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#923ef9"
                                },
                                "seriesUniqueValue": "Interactive Password Authentication",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Small Client File Upload",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#5350fb"
                                },
                                "seriesUniqueValue": "Small Client File Upload",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "SSH Agent Forwarding Requested",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#e51f8f"
                                },
                                "seriesUniqueValue": "SSH Agent Forwarding Requested",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Version Scanning",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#923ef9"
                                },
                                "seriesUniqueValue": "Version Scanning",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Reverse SSH Keystrokes",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#009886"
                                },
                                "seriesUniqueValue": "Reverse SSH Keystrokes",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Reverse SSH Logged In",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#ec453b"
                                },
                                "seriesUniqueValue": "Reverse SSH Logged In",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Reverse SSH Provisioned",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#6f7585"
                                },
                                "seriesUniqueValue": "Reverse SSH Provisioned",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Capabilities Scanning",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#eb730a"
                                },
                                "seriesUniqueValue": "Capabilities Scanning",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Reverse SSH Initiated",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#4aa207"
                                },
                                "seriesUniqueValue": "Reverse SSH Initiated",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Client Authentication Bypass",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#10a3b7"
                                },
                                "seriesUniqueValue": "Client Authentication Bypass",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Large Client File Upload",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#d15f6b"
                                },
                                "seriesUniqueValue": "Large Client File Upload",
                                "areaStyle": {}
                            },
                            {
                                "seriesName": "Authentication Scanning",
                                "stack": "stack",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#009886"
                                },
                                "seriesUniqueValue": "Authentication Scanning",
                                "areaStyle": {}
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "CATEGORY",
                                "displayName": "Time"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE",
                                "displayName": "Count"
                            }
                        ],
                        "legends": [
                            {
                                "bottom": 12,
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "seriesColumn": [
                            "inferences"
                        ],
                        "groupingType": "Stacked"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "a22f74f73454f88c5df879e3d14cf1017c7ce7529f743fa3ecb1ac460ee50f46",
                    "drillDownConfig": {}
                },
                {
                    "name": "6b37186d-3900-4e71-b746-542fb04d1a6b",
                    "displayName": "SSH Host Details",
                    "chartDatasource": {
                        "dashboardQuery": "5ba54869-c5c6-4596-a05a-aa00ba02859e",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "principal.ip",
                                "header": "Source IP"
                            },
                            {
                                "field": "target.ip",
                                "header": "Destination IP"
                            },
                            {
                                "field": "inferences",
                                "header": "Inferences"
                            },
                            {
                                "field": "count",
                                "header": "Count"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "386cb938d160fed66eec11221e91f7312a129d2a856e0d985173b9748be3ac3e",
                    "drillDownConfig": {}
                },
                {
                    "name": "e1c6f231-079e-486f-8b00-24efe9eccefc",
                    "displayName": "Inferences for Hosts with Host Key",
                    "chartDatasource": {
                        "dashboardQuery": "44a27bab-bbb8-4243-9d16-49405521e466",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "principal.ip",
                                "header": "Source IP"
                            },
                            {
                                "field": "target.ip",
                                "header": "Destination IP"
                            },
                            {
                                "field": "host_keys",
                                "header": "Host Key"
                            },
                            {
                                "field": "inferences",
                                "header": "Inferences"
                            },
                            {
                                "field": "count",
                                "header": "Count"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "6be424fc93e7731179f0c92329090da8fc059832130dd84605018a40ec3a2b87",
                    "drillDownConfig": {}
                },
                {
                    "name": "a05c4b0c-08d2-4630-8d6f-137ab824246c",
                    "displayName": "Log Data",
                    "description": "SSH Inference Log Data",
                    "chartDatasource": {
                        "dashboardQuery": "294ccf3c-a1a0-4d6f-ad75-18d3a3b58ddd",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "time",
                                "header": "Time"
                            },
                            {
                                "field": "principal.ip",
                                "header": "Source IP"
                            },
                            {
                                "field": "target.ip",
                                "header": "Destination IP"
                            },
                            {
                                "field": "inferences",
                                "header": "Inferences"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "e9614ce4dec9219e0316eb42b808c54c075b457c40c1a4539764ddf768796595",
                    "drillDownConfig": {}
                },
                {
                    "name": "ca23f4f0-3396-4df6-ac5e-4f78a161ee07",
                    "displayName": "SSH Inferences",
                    "chartDatasource": {
                        "dashboardQuery": "f12849d9-0c48-451f-9517-5dbfee319e1b",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "PIE",
                                "encode": {
                                    "value": "count",
                                    "itemName": "inferences"
                                },
                                "dataLabel": {
                                    "show": true
                                },
                                "radius": [
                                    "0%",
                                    "70%"
                                ],
                                "itemStyle": {
                                    "color": "b=>{const {map:c}=Cyf(this.theme);b=Jzf(b,bzf(this.form.controls.seriesConfig.getRawValue()),a);a=b.nextColorIndex;let d;return(d=\nc.get(b.color))!=null?d:b.color}"
                                },
                                "itemColors": {
                                    "colors": [
                                        {
                                            "key": "Client Trusted Server",
                                            "value": {
                                                "color": "#1a73e8",
                                                "label": "Client Trusted Server"
                                            }
                                        },
                                        {
                                            "key": "Public Key Authentication",
                                            "value": {
                                                "color": "#eb730a",
                                                "label": "Public Key Authentication"
                                            }
                                        },
                                        {
                                            "key": "Automated Interaction",
                                            "value": {
                                                "color": "#10a3b7",
                                                "label": "Automated Interaction"
                                            }
                                        },
                                        {
                                            "key": "Large Client File Download",
                                            "value": {
                                                "color": "#ec453b",
                                                "label": "Large Client File Download"
                                            }
                                        },
                                        {
                                            "key": "Other Scanning",
                                            "value": {
                                                "color": "#e51f8f",
                                                "label": "Other Scanning"
                                            }
                                        },
                                        {
                                            "key": "Keystrokes",
                                            "value": {
                                                "color": "#923ef9",
                                                "label": "Keystrokes"
                                            }
                                        },
                                        {
                                            "key": "Capabilities Scanning",
                                            "value": {
                                                "color": "#6f7585",
                                                "label": "Capabilities Scanning"
                                            }
                                        },
                                        {
                                            "key": "Small Client File Download",
                                            "value": {
                                                "color": "#5350fb",
                                                "label": "Small Client File Download"
                                            }
                                        },
                                        {
                                            "key": "Client Authentication Bypass",
                                            "value": {
                                                "color": "#009886",
                                                "label": "Client Authentication Bypass"
                                            }
                                        },
                                        {
                                            "key": "Reverse SSH Initiated",
                                            "value": {
                                                "color": "#6f7585",
                                                "label": "Reverse SSH Initiated"
                                            }
                                        }
                                    ]
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "8938d65c5557ba642bc62d5529890164d02c2fa7f2077870d7450c1f9b4c8381",
                    "drillDownConfig": {}
                }
            ],
            "dashboardQueries": [
                {
                    "name": "5ba54869-c5c6-4596-a05a-aa00ba02859e",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"ssh\"\r\nsecurity_result.summary !=\"\"\r\n$inference_name=if(security_result.summary = \"Client Authentication Bypass\", \"ABP\",\r\nif(security_result.summary = \"SSH Agent Forwarding Requested\", \"AFR\",\r\nif(security_result.summary = \"Automated Password Authentication\", \"APWA\",\r\nif(security_result.summary = \"Automated Interaction\", \"AUTO\",\r\nif(security_result.summary = \"Server Banner\", \"BAN\",\r\nif(security_result.summary = \"Client Brute Force Guessing\", \"BF\",\r\nif(security_result.summary = \"Client Brute Force Success\", \"BFS\",\r\nif(security_result.summary = \"Client Trusted Server\", \"CTS\",\r\nif(security_result.summary = \"Client Untrusted Server\", \"CUS\",\r\nif(security_result.summary = \"Interactive Password Authentication\", \"IPWA\",\r\nif(security_result.summary = \"Keystrokes\", \"KS\",\r\nif(security_result.summary = \"Large Client File Download\", \"LFD\",\r\nif(security_result.summary = \"Large Client File Upload\", \"LFU\",\r\nif(security_result.summary = \"Multifactor Authentication\", \"MFA\",\r\nif(security_result.summary = \"None Authentication\", \"NA\",\r\nif(security_result.summary = \"No Remote Command\", \"NRC\",\r\nif(security_result.summary = \"Public Key Authentication\", \"PKA\",\r\nif(security_result.summary = \"Reverse SSH Initiated\", \"RSI\",\r\nif(security_result.summary = \"Reverse SSH Initiated Automate\", \"RSIA\",\r\nif(security_result.summary = \"Reverse SSH Keystrokes\", \"RSK\",\r\nif(security_result.summary = \"Reverse SSH Logged In\", \"RSL\",\r\nif(security_result.summary = \"Reverse SSH Provisioned\", \"RSP\",\r\nif(security_result.summary = \"Authentication Scanning\", \"SA\",\r\nif(security_result.summary = \"Capabilities Scanning\", \"SC\",\r\nif(security_result.summary = \"Small Client File Download\", \"SFD\",\r\nif(security_result.summary = \"Small Client File Upload\", \"SFU\",\r\nif(security_result.summary = \"Other Scanning\", \"SP\",\r\nif(security_result.summary = \"Version Scanning\", \"SV\",\r\nif(security_result.summary = \"Unknown Authentication\", \"UA\", \"Unknown\"\r\n)))))))))))))))))))))))))))))\r\nmatch:\r\n    principal.ip, target.ip\r\noutcome:\r\n    $inferences=array_distinct(strings.concat($inference_name, \" : \", security_result.summary))\r\n    $count=count_distinct(metadata.id)\r\norder:\r\n    $count desc\r\nlimit:\r\n    5",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "bdefbe93847fcc47634c52e052c437a1740f1e6ef327c3681e8b665e960b5c8a"
                },
                {
                    "name": "44a27bab-bbb8-4243-9d16-49405521e466",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"ssh\"\r\nsecurity_result.summary !=\"\"\r\n$inference_name=if(security_result.summary = \"Client Authentication Bypass\", \"ABP\",\r\nif(security_result.summary = \"SSH Agent Forwarding Requested\", \"AFR\",\r\nif(security_result.summary = \"Automated Password Authentication\", \"APWA\",\r\nif(security_result.summary = \"Automated Interaction\", \"AUTO\",\r\nif(security_result.summary = \"Server Banner\", \"BAN\",\r\nif(security_result.summary = \"Client Brute Force Guessing\", \"BF\",\r\nif(security_result.summary = \"Client Brute Force Success\", \"BFS\",\r\nif(security_result.summary = \"Client Trusted Server\", \"CTS\",\r\nif(security_result.summary = \"Client Untrusted Server\", \"CUS\",\r\nif(security_result.summary = \"Interactive Password Authentication\", \"IPWA\",\r\nif(security_result.summary = \"Keystrokes\", \"KS\",\r\nif(security_result.summary = \"Large Client File Download\", \"LFD\",\r\nif(security_result.summary = \"Large Client File Upload\", \"LFU\",\r\nif(security_result.summary = \"Multifactor Authentication\", \"MFA\",\r\nif(security_result.summary = \"None Authentication\", \"NA\",\r\nif(security_result.summary = \"No Remote Command\", \"NRC\",\r\nif(security_result.summary = \"Public Key Authentication\", \"PKA\",\r\nif(security_result.summary = \"Reverse SSH Initiated\", \"RSI\",\r\nif(security_result.summary = \"Reverse SSH Initiated Automate\", \"RSIA\",\r\nif(security_result.summary = \"Reverse SSH Keystrokes\", \"RSK\",\r\nif(security_result.summary = \"Reverse SSH Logged In\", \"RSL\",\r\nif(security_result.summary = \"Reverse SSH Provisioned\", \"RSP\",\r\nif(security_result.summary = \"Authentication Scanning\", \"SA\",\r\nif(security_result.summary = \"Capabilities Scanning\", \"SC\",\r\nif(security_result.summary = \"Small Client File Download\", \"SFD\",\r\nif(security_result.summary = \"Small Client File Upload\", \"SFU\",\r\nif(security_result.summary = \"Other Scanning\", \"SP\",\r\nif(security_result.summary = \"Version Scanning\", \"SV\",\r\nif(security_result.summary = \"Unknown Authentication\", \"UA\", \"Unknown\"\r\n)))))))))))))))))))))))))))))\r\n$host_key=if(security_result.detection_fields.key = \"host_key\", security_result.detection_fields[\"host_key\"], network.tls.server.certificate.sha256)\r\n$host_key!=\"\"\r\nmatch:\r\n    principal.ip, target.ip\r\noutcome:\r\n    $host_keys=array_distinct($host_key)\r\n    $inferences=array_distinct(strings.concat($inference_name, \" : \", security_result.summary))\r\n    $count=count_distinct(metadata.id)\r\norder:\r\n    $count desc",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "2e281a1c4fe4acb04597ce2d3689c23bc8dbe9ce716f04323a93381cf9325fb3"
                },
                {
                    "name": "294ccf3c-a1a0-4d6f-ad75-18d3a3b58ddd",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"ssh\"\r\nsecurity_result.summary !=\"\"\r\n$inference_name=if(security_result.summary = \"Client Authentication Bypass\", \"ABP\",\r\nif(security_result.summary = \"SSH Agent Forwarding Requested\", \"AFR\",\r\nif(security_result.summary = \"Automated Password Authentication\", \"APWA\",\r\nif(security_result.summary = \"Automated Interaction\", \"AUTO\",\r\nif(security_result.summary = \"Server Banner\", \"BAN\",\r\nif(security_result.summary = \"Client Brute Force Guessing\", \"BF\",\r\nif(security_result.summary = \"Client Brute Force Success\", \"BFS\",\r\nif(security_result.summary = \"Client Trusted Server\", \"CTS\",\r\nif(security_result.summary = \"Client Untrusted Server\", \"CUS\",\r\nif(security_result.summary = \"Interactive Password Authentication\", \"IPWA\",\r\nif(security_result.summary = \"Keystrokes\", \"KS\",\r\nif(security_result.summary = \"Large Client File Download\", \"LFD\",\r\nif(security_result.summary = \"Large Client File Upload\", \"LFU\",\r\nif(security_result.summary = \"Multifactor Authentication\", \"MFA\",\r\nif(security_result.summary = \"None Authentication\", \"NA\",\r\nif(security_result.summary = \"No Remote Command\", \"NRC\",\r\nif(security_result.summary = \"Public Key Authentication\", \"PKA\",\r\nif(security_result.summary = \"Reverse SSH Initiated\", \"RSI\",\r\nif(security_result.summary = \"Reverse SSH Initiated Automate\", \"RSIA\",\r\nif(security_result.summary = \"Reverse SSH Keystrokes\", \"RSK\",\r\nif(security_result.summary = \"Reverse SSH Logged In\", \"RSL\",\r\nif(security_result.summary = \"Reverse SSH Provisioned\", \"RSP\",\r\nif(security_result.summary = \"Authentication Scanning\", \"SA\",\r\nif(security_result.summary = \"Capabilities Scanning\", \"SC\",\r\nif(security_result.summary = \"Small Client File Download\", \"SFD\",\r\nif(security_result.summary = \"Small Client File Upload\", \"SFU\",\r\nif(security_result.summary = \"Other Scanning\", \"SP\",\r\nif(security_result.summary = \"Version Scanning\", \"SV\",\r\nif(security_result.summary = \"Unknown Authentication\", \"UA\", \"Unknown\"\r\n)))))))))))))))))))))))))))))\r\n$time=timestamp.get_timestamp(metadata.event_timestamp.seconds)\r\nmatch:\r\n    $time, principal.ip, target.ip\r\noutcome:\r\n    $inferences=array_distinct($inference_name)\r\norder:\r\n    $time desc",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "d5b3e91831b6cb909b143b24eafb2340abc14a0a62883773eaa24ca9b18bcffa"
                },
                {
                    "name": "f12849d9-0c48-451f-9517-5dbfee319e1b",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"ssh\"\r\n$inferences=security_result.summary\r\n$inferences!=\"\"\r\nmatch:\r\n    $inferences\r\noutcome:\r\n    $count=count_distinct(metadata.id)\r\norder:\r\n    $count desc\r\nlimit:\r\n    10",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "a84c8b720854234a952b12716e450a5e099f91d27fd95b5e58d8b0b8fde00d5d"
                },
                {
                    "name": "e0563f4c-607b-4ddf-ba8f-64fa9d4a179f",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"ssh\"\r\n\r\n$date=timestamp.get_date(metadata.event_timestamp.seconds)\r\n$hassh=if(principal.labels[\"hassh\"]!=\"\", principal.labels[\"hassh\"], \"Unknown\")\r\n$hassh_server=if(target.labels[\"hassh_server\"]!=\"\", target.labels[\"hassh_server\"], \"Unknown\")\r\n$principal_ip=if(principal.ip!=\"\", principal.ip, \"Unknown\")\r\n$target_ip=if(target.ip!=\"\", target.ip, \"Unknown\")\r\n\r\nmatch:\r\n    $principal_ip, $hassh, $target_ip, $hassh_server\r\noutcome:\r\n    $count=count_distinct(metadata.id)\r\norder:\r\n    $count desc\r\nlimit:\r\n    5",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "3f7b3e549eb377e36814d41ffd7d9d04a941d4c9deefc65125da3cf16bb5fd1a"
                },
                {
                    "name": "0d30ffc7-6197-42eb-b09e-ec411aaf1b2e",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type = \"ssh\"\r\n$inferences=security_result.summary\r\n$inferences!=\"\"\r\n$date_hour=timestamp.get_timestamp(metadata.event_timestamp.seconds, \"%Y-%m-%d : %H\")\r\nmatch:\r\n    $date_hour, $inferences\r\noutcome:\r\n    $count=count_distinct(metadata.id)\r\norder:\r\n    $date_hour asc\r\n\r\n",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "5046c72f6b89d2002387b16f24a9250f66412804b83002896014ccb0c988fa47"
                }
            ]
        }
    ]
}