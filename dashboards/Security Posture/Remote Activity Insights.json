{
    "dashboards": [
        {
            "dashboard": {
                "name": "3b9b300b-8e8c-4dc8-969b-bc3b31b43d02",
                "displayName": "Corelight → Data Insights → Remote Activity Insights",
                "definition": {
                    "filters": [
                        {
                            "id": "GlobalTimeFilter",
                            "dataSource": "GLOBAL",
                            "filterOperatorAndFieldValues": [
                                {
                                    "filterOperator": "PAST",
                                    "fieldValues": [
                                        "1",
                                        "DAY"
                                    ]
                                }
                            ],
                            "displayName": "Global Time Filter",
                            "chartIds": [
                                "daa13044-a597-467a-bba2-b4001e7b0e78",
                                "39b3b71e-ebc9-43e9-b85b-639b93f05c70",
                                "34a20195-d66d-4314-ac32-1a806a1ab16c",
                                "8267b3be-f494-4cc1-9bf9-ee8c75c87ea0",
                                "95154f0e-cdd7-40d6-bf2b-aa1023a5302b",
                                "c9007d71-3d38-44f8-a795-fcfb5846f822",
                                "2c6cf935-57fa-4141-927f-862c6049a07a",
                                "95f092ee-152a-4439-824d-ed974aed2a5c",
                                "6fe85796-0749-4d7e-917f-576f3a90400a",
                                "53b538fa-48ec-43c4-b93d-637eaf2fe233"
                            ],
                            "isStandardTimeRangeFilter": true,
                            "isStandardTimeRangeFilterEnabled": true
                        }
                    ],
                    "charts": [
                        {
                            "dashboardChart": "c9007d71-3d38-44f8-a795-fcfb5846f822",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 0,
                                "spanY": 16
                            },
                            "filtersIds": [
                                "GlobalTimeFilter"
                            ]
                        },
                        {
                            "dashboardChart": "6fe85796-0749-4d7e-917f-576f3a90400a",
                            "chartLayout": {
                                "startX": 48,
                                "spanX": 48,
                                "startY": 0,
                                "spanY": 16
                            },
                            "filtersIds": [
                                "GlobalTimeFilter"
                            ]
                        },
                        {
                            "dashboardChart": "2c6cf935-57fa-4141-927f-862c6049a07a",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 16,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter"
                            ]
                        },
                        {
                            "dashboardChart": "39b3b71e-ebc9-43e9-b85b-639b93f05c70",
                            "chartLayout": {
                                "startX": 48,
                                "spanX": 48,
                                "startY": 16,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter"
                            ]
                        },
                        {
                            "dashboardChart": "8267b3be-f494-4cc1-9bf9-ee8c75c87ea0",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 43,
                                "spanY": 16
                            },
                            "filtersIds": [
                                "GlobalTimeFilter"
                            ]
                        },
                        {
                            "dashboardChart": "daa13044-a597-467a-bba2-b4001e7b0e78",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 59,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter"
                            ]
                        },
                        {
                            "dashboardChart": "34a20195-d66d-4314-ac32-1a806a1ab16c",
                            "chartLayout": {
                                "startX": 48,
                                "spanX": 48,
                                "startY": 43,
                                "spanY": 16
                            },
                            "filtersIds": [
                                "GlobalTimeFilter"
                            ]
                        },
                        {
                            "dashboardChart": "95f092ee-152a-4439-824d-ed974aed2a5c",
                            "chartLayout": {
                                "startX": 48,
                                "spanX": 48,
                                "startY": 59,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter"
                            ]
                        },
                        {
                            "dashboardChart": "95154f0e-cdd7-40d6-bf2b-aa1023a5302b",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 86,
                                "spanY": 16
                            },
                            "filtersIds": [
                                "GlobalTimeFilter"
                            ]
                        },
                        {
                            "dashboardChart": "53b538fa-48ec-43c4-b93d-637eaf2fe233",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 102,
                                "spanY": 28
                            },
                            "filtersIds": [
                                "GlobalTimeFilter"
                            ]
                        }
                    ]
                },
                "type": "CUSTOM",
                "etag": "e0524fd50402499b7e6dcfb3e5b4c2f0e61911fd5f5329b8ba36f4bfa0b87565",
                "access": "DASHBOARD_PRIVATE"
            },
            "dashboardCharts": [
                {
                    "name": "6fe85796-0749-4d7e-917f-576f3a90400a",
                    "displayName": " Identifying Failed RDP Logins",
                    "description": "Monitoring failed RDP logins is essential for detecting unauthorized access attempts. Security teams should analyze patterns of failed entries against user and IP data to identify potential breaches. This focus helps in quickly addressing vulnerabilities in RDP security. Effective monitoring of these incidents is crucial for maintaining system integrity.",
                    "chartDatasource": {
                        "dashboardQuery": "532512d2-1725-4101-bfd2-75e16a6a1d43",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "TEXT",
                                "label": "Total count of users with login failures within the specified time.",
                                "field": "count",
                                "metricTrendConfig": {
                                    "metricFormat": "METRIC_FORMAT_PLAIN_TEXT",
                                    "metricDisplayTrend": "METRIC_DISPLAY_TREND_ABSOLUTE_VALUE",
                                    "metricTrendType": "METRIC_TREND_TYPE_REGULAR"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "465e9839255998e2000c1c423457de1b401d3af29b2a4ef5650a7ea20a353c6c",
                    "drillDownConfig": {}
                },
                {
                    "name": "39b3b71e-ebc9-43e9-b85b-639b93f05c70",
                    "displayName": " ",
                    "chartDatasource": {
                        "dashboardQuery": "63e77b08-451b-4054-87df-ffcb34aca26d",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "User",
                                "header": "User"
                            },
                            {
                                "field": "Source",
                                "header": "Source IP"
                            },
                            {
                                "field": "Destination",
                                "header": "Destination IP"
                            },
                            {
                                "field": "Auth_Success",
                                "header": "Auth Success?"
                            },
                            {
                                "field": "Result",
                                "header": "Result"
                            },
                            {
                                "field": "count",
                                "header": "Count"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "e40030065fb2ec67e85b1e4e62b3c8d28e7f48a1124f70c0c5e5c6c8264f1eae",
                    "drillDownConfig": {}
                },
                {
                    "name": "95154f0e-cdd7-40d6-bf2b-aa1023a5302b",
                    "displayName": " Possible Unauthorized Remote Access Attempts",
                    "description": "Monitoring for \"RW\" (Road Warrior) and \"FW\" (Firewall subversion) inferences is crucial for detecting potential unauthorized access, as these patterns may indicate attempts to bypass security controls. Security teams should prioritize correlating these inferences with internal IP ranges and device logs to identify suspicious activities.",
                    "chartDatasource": {
                        "dashboardQuery": "45c70baf-7154-414e-804c-d0a5e09207a5",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "TEXT",
                                "label": "Total count of VPN connections that are using the RW- Road warrior configuration detected (i.e. Cisco Anyconnect) and FW - Firewall subversion inferences",
                                "field": "count",
                                "metricTrendConfig": {
                                    "metricFormat": "METRIC_FORMAT_NUMBER",
                                    "metricDisplayTrend": "METRIC_DISPLAY_TREND_ABSOLUTE_VALUE",
                                    "metricTrendType": "METRIC_TREND_TYPE_REGULAR"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "25e55683048e4c4052ec3914523fc554231105e0a21387e95c6c06a4b0eacb9f",
                    "drillDownConfig": {}
                },
                {
                    "name": "c9007d71-3d38-44f8-a795-fcfb5846f822",
                    "displayName": " RDP Authentication Attempts",
                    "description": "Monitoring RDP authentications is crucial for identifying unauthorized access and distinguishing between successful and failed login attempts. Security teams should analyze trends and cross-reference user activity for rapid response and mitigation.",
                    "chartDatasource": {
                        "dashboardQuery": "8654f6da-c0c0-4a62-9012-9ea9a91c394c",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "TEXT",
                                "label": "Total count of RDP success and failed actions within the specified time.",
                                "field": "count",
                                "metricTrendConfig": {
                                    "metricFormat": "METRIC_FORMAT_PLAIN_TEXT",
                                    "metricDisplayTrend": "METRIC_DISPLAY_TREND_ABSOLUTE_VALUE",
                                    "metricTrendType": "METRIC_TREND_TYPE_REGULAR"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "fdb8d00d6beb5efc3ae7336bf0634d54fc262de34cf9567848c4d6b4ddd93f01",
                    "drillDownConfig": {}
                },
                {
                    "name": "daa13044-a597-467a-bba2-b4001e7b0e78",
                    "displayName": " ",
                    "chartDatasource": {
                        "dashboardQuery": "8f87281b-2d8b-4783-8532-0804f893d315",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "principal.ip",
                                "header": "Source IP"
                            },
                            {
                                "field": "target.ip",
                                "header": "Destination IP"
                            },
                            {
                                "field": "about.labels.value",
                                "header": "Inferences"
                            },
                            {
                                "field": "vpn_type",
                                "header": "VPN Type"
                            },
                            {
                                "field": "count",
                                "header": "Count"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "466ac4da7a7d38e5c9261d014d8403b5a790394c060e45ca1ce5c4dc7986d230",
                    "drillDownConfig": {
                        "leftDrillDowns": [
                            {
                                "id": "principal.ip",
                                "displayName": "Run Search on principal.ip",
                                "defaultSettings": {
                                    "enabled": true
                                }
                            },
                            {
                                "id": "target.ip",
                                "displayName": "Run Search on target.ip",
                                "defaultSettings": {
                                    "enabled": true
                                }
                            },
                            {
                                "id": "about.labels.value",
                                "displayName": "Run Search on about.labels.value",
                                "defaultSettings": {
                                    "enabled": true
                                }
                            },
                            {
                                "id": "vpn_type",
                                "displayName": "Run Search on VPN Type",
                                "defaultSettings": {
                                    "enabled": true
                                }
                            }
                        ]
                    }
                },
                {
                    "name": "53b538fa-48ec-43c4-b93d-637eaf2fe233",
                    "displayName": " ",
                    "chartDatasource": {
                        "dashboardQuery": "0d182617-15f0-4750-b6bf-02c0d28c6b56",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "Source",
                                "header": "Source IP"
                            },
                            {
                                "field": "Destination",
                                "header": "Destination IP"
                            },
                            {
                                "field": "proto",
                                "header": "Proto"
                            },
                            {
                                "field": "inferences",
                                "header": "Inferences"
                            },
                            {
                                "field": "Dest_port",
                                "header": "Dest Port"
                            },
                            {
                                "field": "Bytes",
                                "header": "Bytes"
                            },
                            {
                                "field": "count",
                                "header": "Count"
                            },
                            {
                                "field": "uid",
                                "header": "UID"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "1250e3071096af811fdd3753ed1f939001de29c697de1f0cbb8e809484b808af",
                    "drillDownConfig": {
                        "leftDrillDowns": [
                            {
                                "id": "uid",
                                "displayName": "Run Search on UID",
                                "defaultSettings": {
                                    "enabled": true
                                }
                            }
                        ]
                    }
                },
                {
                    "name": "34a20195-d66d-4314-ac32-1a806a1ab16c",
                    "displayName": " Suspected Data Exfiltration",
                    "description": "Unmonitored commercial VPNs with atypical traffic patterns or static keys could be used to bypass security controls for data theft. Investigate: Examine VPN sessions with large outgoing transfers, focusing on unusual destinations or protocols.",
                    "chartDatasource": {
                        "dashboardQuery": "3d5ef21a-07ab-4223-bda3-295b98a0a8c8",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "TEXT",
                                "label": "Total count of VPN connections using potentially unusual connection configurations such as static TLS key auth",
                                "field": "count",
                                "metricTrendConfig": {
                                    "metricFormat": "METRIC_FORMAT_NUMBER",
                                    "metricDisplayTrend": "METRIC_DISPLAY_TREND_ABSOLUTE_VALUE",
                                    "metricTrendType": "METRIC_TREND_TYPE_REGULAR"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "ec5e82a566ffbd8ccc92d8c227b1b2fa12813f8c6627f920e48ee3b64900ff21",
                    "drillDownConfig": {}
                },
                {
                    "name": "95f092ee-152a-4439-824d-ed974aed2a5c",
                    "displayName": " ",
                    "chartDatasource": {
                        "dashboardQuery": "9cf0196a-47f4-4a7a-876f-b95fa89618c6",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "principal.ip",
                                "header": "Source Ip"
                            },
                            {
                                "field": "target.ip",
                                "header": "Destination IP"
                            },
                            {
                                "field": "inferences",
                                "header": "Inference"
                            },
                            {
                                "field": "Responder_Country",
                                "header": "Responder Country"
                            },
                            {
                                "field": "vpn_type",
                                "header": "VPN Type"
                            },
                            {
                                "field": "count",
                                "header": "Count"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "3807723de561c76030b711d7e7203ba3544dbe972f0683d04397824434508d58",
                    "drillDownConfig": {}
                },
                {
                    "name": "2c6cf935-57fa-4141-927f-862c6049a07a",
                    "displayName": "Failed vs Successful Authentications",
                    "description": "Total count of RDP success and failed actions within the specified time",
                    "chartDatasource": {
                        "dashboardQuery": "1522525b-4fe2-4fb3-9eca-c304b9606d99",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {}
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "CATEGORY",
                                "displayName": "Time"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "CATEGORY",
                                "displayName": "Count"
                            }
                        ],
                        "legends": [
                            {
                                "bottom": 12,
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "seriesColumn": [
                            "action"
                        ],
                        "groupingType": "Grouped"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "d142575ae55ce1e85c8a78a27c20bcb440d876f4fe828b06a92369e31393d560",
                    "drillDownConfig": {}
                },
                {
                    "name": "8267b3be-f494-4cc1-9bf9-ee8c75c87ea0",
                    "displayName": " Unusual Remote Activity",
                    "description": "The combination of the \"COM\", \"RW\", and \"NSP\" inferences in a single VPN connection raises questions: Policy Violation: Is the use of commercial VPNs allowed in your organization's security policy? If not, this could indicate a violation. Hidden Activity: Is the non-standard port usage an attempt to mask other activities happening over the VPN tunnel?",
                    "chartDatasource": {
                        "dashboardQuery": "070d1396-e67b-4b95-a335-829db3a7bdba",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "TEXT",
                                "label": "Total count of VPN connections that have the following inferences NSP - Non-Standard Port RW - Road warrior configuration detected (i.e. Cisco Anyconnect) COM - Commercial VPN service occurring at the same time which is deemed suspicious",
                                "field": "count",
                                "metricTrendConfig": {
                                    "metricFormat": "METRIC_FORMAT_NUMBER",
                                    "metricDisplayTrend": "METRIC_DISPLAY_TREND_ABSOLUTE_VALUE",
                                    "metricTrendType": "METRIC_TREND_TYPE_REGULAR"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "d88d78f3aff3de3bf4a0c78d38d1047548b18f49225e49e5e0375e9495c40872",
                    "drillDownConfig": {}
                }
            ],
            "dashboardQueries": [
                {
                    "name": "45c70baf-7154-414e-804c-d0a5e09207a5",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type=\"vpn\"\r\nabout.labels.key=\"inference\"\r\nabout.labels.value = \"RW\" OR about.labels.value = \"FW\"\r\n\r\noutcome:\r\n    $count = count_distinct(network.session_id)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "84dd75f9192230caaf1853b3d6da57ac11bd06d69d4b8253cc1089b4b66de4f1"
                },
                {
                    "name": "1522525b-4fe2-4fb3-9eca-c304b9606d99",
                    "query": "metadata.vendor_name = \"Corelight\" \r\nmetadata.product_event_type = \"rdp\"\r\n$action=if(about.labels[\"result\"] = \"Success\", \"success\", \r\n            if(about.labels[\"result\"] = \"SSL_NOT_ALLOWED_BY_SERVER\", \"failure\",\r\n            if(security_result.action = \"ALLOW\", \"success\",\r\n            if(security_result.action = \"FAIL\", \"failure\", \"Unknown\"\r\n        ))))\r\n$action!=\"Unknown\"\r\n$date_hour=timestamp.get_timestamp(metadata.event_timestamp.seconds, \"%Y-%m-%d : %H\")\r\nmatch:\r\n    $date_hour, $action\r\noutcome:\r\n    $count = count(metadata.id)\r\n",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "ecb1958e4cf34c3bff592d52450582ff23a752260036e2a29779a9f97ef58708"
                },
                {
                    "name": "8654f6da-c0c0-4a62-9012-9ea9a91c394c",
                    "query": "metadata.vendor_name = \"Corelight\" \r\nmetadata.product_event_type = \"rdp\"\r\n$action=if(about.labels[\"result\"] = \"Success\", \"success\", \r\n            if(about.labels[\"result\"] = \"SSL_NOT_ALLOWED_BY_SERVER\", \"failure\",\r\n            if(security_result.action = \"ALLOW\", \"Success\",\r\n            if(security_result.action = \"FAIL\", \"failure\", \"Unknown\"\r\n        ))))\r\n$action!=\"Unknown\"\r\noutcome:\r\n    $count = count(metadata.id)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "1ea687608315e24679650d02a9786c3b51d3f9121999395cb6f9d636c31d389b"
                },
                {
                    "name": "070d1396-e67b-4b95-a335-829db3a7bdba",
                    "query": "metadata.vendor_name = \"Corelight\"\r\nmetadata.product_event_type = \"vpn\"\r\nabout.labels.key=\"inference\"\r\nabout.labels.value = \"COM\" OR about.labels.value = \"NSP\" OR about.labels.value = \"RW\"\r\n$combine_count = strings.concat(principal.ip, target.ip, about.labels.value, about.labels[\"vpn_type\"])\r\n\r\noutcome:\r\n    $count=count_distinct($combine_count)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "WEEK",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "820c6a11de3f7ed48a98a87a2ce659f4426d932f89b2d5f93204ef687a096b8b"
                },
                {
                    "name": "532512d2-1725-4101-bfd2-75e16a6a1d43",
                    "query": "metadata.vendor_name = \"Corelight\" \r\nmetadata.product_event_type = \"rdp\"\r\nabout.labels[\"result\"]=\"SSL_NOT_ALLOWED_BY_SERVER\" OR security_result.action=\"FAIL\"\r\n$cookie=about.labels[\"cookie\"]\r\n$cookie!=\"\"\r\n\r\noutcome:\r\n    $count=count_distinct($cookie)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "d0ca1d753afba0e8683b8551e884c0a6252f16941a91ce52cf4e71e14f3a40ab"
                },
                {
                    "name": "0d182617-15f0-4750-b6bf-02c0d28c6b56",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type=\"vpn\"\r\nabout.labels.key=\"inference\"\r\nabout.labels.value = \"RW\" OR about.labels.value = \"FW\"\r\n$uid=network.session_id\r\n$protocol_version=if(network.ip_protocol = 88, \"EIGRP\", \r\n                    if(network.ip_protocol = 50, \"ESP\",\r\n                    if(network.ip_protocol = 97, \"ETHERIP\",\r\n                    if(network.ip_protocol = 47, \"GRE\", \r\n                    if(network.ip_protocol = 1, \"ICMP\",\r\n                    if(network.ip_protocol = 58, \"ICMP6\",\r\n                    if(network.ip_protocol = 2, \"IGMP\",\r\n                    if(network.ip_protocol = 41, \"IP6IN4\",\r\n                    if(network.ip_protocol = 103, \"PIM\",\r\n                    if(network.ip_protocol = 132, \"SCTP\",\r\n                    if(network.ip_protocol = 6, \"TCP\",\r\n                    if(network.ip_protocol = 17, \"UDP\",\r\n                    if(network.ip_protocol = 0, \"UNKNOWN_IP_PROTOCOL\",\r\n                    if(network.ip_protocol = 112, \"VRRP\", \"UNKNOWN_IP_PROTOCOL\"\r\n                ))))))))))))))\r\n\r\nmatch:\r\n    $uid\r\n\r\noutcome:\r\n    $Source=array_distinct(principal.ip)\r\n    $Destination=array_distinct(target.ip)\r\n    $proto=array($protocol_version)\r\n    $inferences=array_distinct(about.labels.value)\r\n    $Dest_port=array_distinct(target.port)\r\n    $Bytes=array_distinct(network.sent_bytes)\r\n    $count = count_distinct(metadata.id)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "067381b4caa6b76488d409f6510bcb69efa25453da0560765ae1ca4d9a18ca21"
                },
                {
                    "name": "9cf0196a-47f4-4a7a-876f-b95fa89618c6",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type=\"vpn\"\r\nabout.labels.key=\"inference\"\r\nabout.labels.value = \"COM\" OR about.labels.value = \"NSP\" OR about.labels.value = \"SK\"\r\n\r\nmatch:\r\n    principal.ip, target.ip\r\n\r\noutcome:\r\n    $inferences=array_distinct(about.labels.value)\r\n    $Responder_Country=array_distinct(target.location.country_or_region)\r\n    $vpn_type=array_distinct(about.labels[\"vpn_type\"])\r\n    $count=count_distinct(metadata.id)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "d3ac42b3db6e48c0fe817d00fa168b828a8c89e0a8c8926ff3a0355875ec7f74"
                },
                {
                    "name": "8f87281b-2d8b-4783-8532-0804f893d315",
                    "query": "metadata.vendor_name = \"Corelight\"\r\nmetadata.product_event_type = \"vpn\"\r\nabout.labels.key=\"inference\"\r\nabout.labels.value = \"COM\" OR about.labels.value = \"NSP\" OR about.labels.value = \"RW\"\r\n$vpn_type=about.labels[\"vpn_type\"]\r\n\r\nmatch:\r\n    principal.ip, target.ip, about.labels.value, $vpn_type\r\n\r\noutcome:\r\n    $count=count_distinct(metadata.id)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "227071f2ff9aaba4d03586b9995673cc903a711c422098e9c83471bfef57e862"
                },
                {
                    "name": "3d5ef21a-07ab-4223-bda3-295b98a0a8c8",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type=\"vpn\"\r\nabout.labels.key=\"inference\"\r\nabout.labels.value = \"COM\" OR about.labels.value = \"NSP\" OR about.labels.value = \"SK\"\r\n$combine_count = strings.concat(principal.ip, target.ip)\r\n\r\noutcome:\r\n    $count=count_distinct($combine_count)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "a762fd470b4f0f8a525f8c6c422c2b21934e66ee680859a88be2512296e40870"
                },
                {
                    "name": "63e77b08-451b-4054-87df-ffcb34aca26d",
                    "query": "metadata.vendor_name = \"Corelight\" \r\nmetadata.product_event_type = \"rdp\"\r\n$result=about.labels[\"result\"]\r\n$auth_success=security_result.action\r\n$result=\"SSL_NOT_ALLOWED_BY_SERVER\" OR $auth_success=\"FAIL\"\r\n$User=about.labels[\"cookie\"]\r\n$User!=\"\"\r\n\r\nmatch:\r\n    $User\r\n\r\noutcome:\r\n    $Source=array_distinct(principal.ip)\r\n    $Destination=array_distinct(target.ip)\r\n    $Auth_Success=array_distinct($auth_success)\r\n    $Result=array_distinct($result)\r\n    $count=count(metadata.id)\r\norder:\r\n    $count desc",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "90ae42b6e5e65572a44b28a02336647f48a6991d16372515647a0dd4c1b7e3cc"
                }
            ]
        }
    ]
}