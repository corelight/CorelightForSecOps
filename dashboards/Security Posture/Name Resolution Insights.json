{
    "dashboards": [
        {
            "dashboard": {
                "name": "9f746b93-0b8e-434f-ad9b-59c78db5aecb",
                "displayName": "Corelight → Data Insights → Name Resolution Insights",
                "definition": {
                    "filters": [
                        {
                            "id": "GlobalTimeFilter",
                            "dataSource": "GLOBAL",
                            "filterOperatorAndFieldValues": [
                                {
                                    "filterOperator": "PAST",
                                    "fieldValues": [
                                        "1",
                                        "DAY"
                                    ]
                                }
                            ],
                            "displayName": "Global Time Filter",
                            "chartIds": [
                                "f55ea4eb-36c6-40cd-8c4b-0ed1125a007b",
                                "b81b89ce-a79a-43e2-827a-f42bfefd0604",
                                "de820be7-1cce-4573-8777-8e5ef6237dac",
                                "1be4ba3b-df79-4a0a-aded-b479dc167954",
                                "ccaf7b27-7901-4a76-8bca-2a78a5c247ec",
                                "15135630-888a-4237-9d8f-2f3ed41308f1",
                                "7c70144c-803c-4ee2-9360-f2f73f6035e7",
                                "26b6dfc5-e6a7-4e4e-b6ad-21883194b716",
                                "17f692da-face-4197-aaa2-6e331742ccc4",
                                "b708a9d3-6e6a-4357-8149-5dc3a9418625",
                                "e6daa64c-9506-450f-9b23-ad8f4953d8c6"
                            ],
                            "isStandardTimeRangeFilter": true,
                            "isStandardTimeRangeFilterEnabled": true
                        },
                        {
                            "id": "149ccd16-7f88-4c26-98ca-bea7571ed04d",
                            "dataSource": "UDM",
                            "fieldPath": "observer.hostname",
                            "filterOperatorAndFieldValues": [
                                {
                                    "filterOperator": "EQUAL",
                                    "fieldValues": [
                                        ""
                                    ]
                                }
                            ],
                            "displayName": "Corelight Sensor",
                            "chartIds": [
                                "b708a9d3-6e6a-4357-8149-5dc3a9418625",
                                "b81b89ce-a79a-43e2-827a-f42bfefd0604",
                                "1be4ba3b-df79-4a0a-aded-b479dc167954",
                                "ccaf7b27-7901-4a76-8bca-2a78a5c247ec",
                                "7c70144c-803c-4ee2-9360-f2f73f6035e7",
                                "e6daa64c-9506-450f-9b23-ad8f4953d8c6",
                                "26b6dfc5-e6a7-4e4e-b6ad-21883194b716",
                                "17f692da-face-4197-aaa2-6e331742ccc4",
                                "15135630-888a-4237-9d8f-2f3ed41308f1",
                                "de820be7-1cce-4573-8777-8e5ef6237dac",
                                "f55ea4eb-36c6-40cd-8c4b-0ed1125a007b"
                            ]
                        }
                    ],
                    "charts": [
                        {
                            "dashboardChart": "e6daa64c-9506-450f-9b23-ad8f4953d8c6",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 0,
                                "spanY": 16
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "149ccd16-7f88-4c26-98ca-bea7571ed04d"
                            ]
                        },
                        {
                            "dashboardChart": "7c70144c-803c-4ee2-9360-f2f73f6035e7",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 16,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "149ccd16-7f88-4c26-98ca-bea7571ed04d"
                            ]
                        },
                        {
                            "dashboardChart": "15135630-888a-4237-9d8f-2f3ed41308f1",
                            "chartLayout": {
                                "startX": 48,
                                "spanX": 48,
                                "startY": 0,
                                "spanY": 16
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "149ccd16-7f88-4c26-98ca-bea7571ed04d"
                            ]
                        },
                        {
                            "dashboardChart": "b81b89ce-a79a-43e2-827a-f42bfefd0604",
                            "chartLayout": {
                                "startX": 48,
                                "spanX": 48,
                                "startY": 16,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "149ccd16-7f88-4c26-98ca-bea7571ed04d"
                            ]
                        },
                        {
                            "dashboardChart": "17f692da-face-4197-aaa2-6e331742ccc4",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 43,
                                "spanY": 16
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "149ccd16-7f88-4c26-98ca-bea7571ed04d"
                            ]
                        },
                        {
                            "dashboardChart": "ccaf7b27-7901-4a76-8bca-2a78a5c247ec",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 59,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "149ccd16-7f88-4c26-98ca-bea7571ed04d"
                            ]
                        },
                        {
                            "dashboardChart": "f55ea4eb-36c6-40cd-8c4b-0ed1125a007b",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 86,
                                "spanY": 16
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "149ccd16-7f88-4c26-98ca-bea7571ed04d"
                            ]
                        },
                        {
                            "dashboardChart": "b708a9d3-6e6a-4357-8149-5dc3a9418625",
                            "chartLayout": {
                                "startX": 48,
                                "spanX": 48,
                                "startY": 43,
                                "spanY": 43
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "149ccd16-7f88-4c26-98ca-bea7571ed04d"
                            ]
                        },
                        {
                            "dashboardChart": "de820be7-1cce-4573-8777-8e5ef6237dac",
                            "chartLayout": {
                                "startX": 0,
                                "spanX": 48,
                                "startY": 102,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "149ccd16-7f88-4c26-98ca-bea7571ed04d"
                            ]
                        },
                        {
                            "dashboardChart": "1be4ba3b-df79-4a0a-aded-b479dc167954",
                            "chartLayout": {
                                "startX": 48,
                                "spanX": 48,
                                "startY": 86,
                                "spanY": 16
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "149ccd16-7f88-4c26-98ca-bea7571ed04d"
                            ]
                        },
                        {
                            "dashboardChart": "26b6dfc5-e6a7-4e4e-b6ad-21883194b716",
                            "chartLayout": {
                                "startX": 48,
                                "spanX": 48,
                                "startY": 102,
                                "spanY": 27
                            },
                            "filtersIds": [
                                "GlobalTimeFilter",
                                "149ccd16-7f88-4c26-98ca-bea7571ed04d"
                            ]
                        }
                    ]
                },
                "type": "CUSTOM",
                "etag": "c58dfd1b204a9624c82168a2171e6ed27f6d8f65e11c90db8c555f0e2ce0b79d",
                "access": "DASHBOARD_PRIVATE"
            },
            "dashboardCharts": [
                {
                    "name": "15135630-888a-4237-9d8f-2f3ed41308f1",
                    "displayName": " Unusual Qtypes",
                    "description": "Unusual DNS query types can indicate misconfigurations, experimental features, or potential security threats like data exfiltration or tunneling. Analysts should scrutinize such queries for anomalies and address identified risks to safeguard network security.",
                    "chartDatasource": {
                        "dashboardQuery": "8fcba1cf-22d3-4079-b57d-ac616aabff3e",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "TEXT",
                                "label": " ",
                                "field": "count",
                                "metricTrendConfig": {
                                    "metricFormat": "METRIC_FORMAT_NUMBER",
                                    "metricDisplayTrend": "METRIC_DISPLAY_TREND_ABSOLUTE_VALUE",
                                    "metricTrendType": "METRIC_TREND_TYPE_REGULAR"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "bfc56a48c1535f6e949c3d9881bfca4b73a9633a47fe888a31174f7f7fc0adb1"
                },
                {
                    "name": "26b6dfc5-e6a7-4e4e-b6ad-21883194b716",
                    "displayName": "Monitoring Query Types by AVG Time",
                    "chartDatasource": {
                        "dashboardQuery": "20a06dc7-93f1-4bb9-820d-eebfb152eb2a",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesName": "Unspecified",
                                "seriesType": "LINE",
                                "encode": {
                                    "x": "date_hour",
                                    "y": "count"
                                },
                                "dataLabel": {},
                                "itemStyle": {
                                    "color": "#1a73e8"
                                },
                                "seriesUniqueValue": "undefined"
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "CATEGORY",
                                "displayName": "Time"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE",
                                "displayName": "Count"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "26fd9f1a220ff410835a8afdc1fce5712ac568e4e555f96cf4d94186740b1b2b"
                },
                {
                    "name": "e6daa64c-9506-450f-9b23-ad8f4953d8c6",
                    "displayName": " Responding DNS Servers",
                    "description": "DNS servers actively responding in the network are key to secure operations, translating domain names to IP addresses and directing traffic. It also logs the number of queries and unique clients interacting with the DNS servers, offering insights into possible rogue DNS servers and detecting patterns that may suggest data exfiltration attempts.",
                    "chartDatasource": {
                        "dashboardQuery": "b519b4cd-989e-4862-a7d9-264e7b27d042",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "TEXT",
                                "label": " ",
                                "field": "count",
                                "metricTrendConfig": {
                                    "metricFormat": "METRIC_FORMAT_NUMBER",
                                    "metricDisplayTrend": "METRIC_DISPLAY_TREND_ABSOLUTE_VALUE",
                                    "metricTrendType": "METRIC_TREND_TYPE_REGULAR"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "00567aee49a16401658718e22d4eb9a8c52ec6aa816db8cfed1447345d7c3e0e"
                },
                {
                    "name": "ccaf7b27-7901-4a76-8bca-2a78a5c247ec",
                    "displayName": "Network Evidence for NXDOMAIN Responses",
                    "chartDatasource": {
                        "dashboardQuery": "5169a7c2-d75a-426e-9194-77b296d471f1",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "principal.ip",
                                "header": "Source"
                            },
                            {
                                "field": "target.ip",
                                "header": "Responder"
                            },
                            {
                                "field": "network.dns.questions.name",
                                "header": "Query"
                            },
                            {
                                "field": "query_rejected",
                                "header": "Rejected?"
                            },
                            {
                                "field": "count",
                                "header": "count"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "6b22adf7434fc12244f020736b844335362e0f2f85f76a0f43f1729b35e794e6"
                },
                {
                    "name": "1be4ba3b-df79-4a0a-aded-b479dc167954",
                    "displayName": "DNS Query Volume Over Time",
                    "description": "Monitor total DNS-related network traffic in MB/GB. Sudden spikes or unusual patterns could signal configuration errors, compromised devices making excessive queries, or potential data exfiltration attempts.",
                    "chartDatasource": {
                        "dashboardQuery": "db46fcd3-8323-4b75-afcc-458ed2d17956",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "TEXT",
                                "label": " ",
                                "field": "total_traffic",
                                "metricTrendConfig": {
                                    "metricFormat": "METRIC_FORMAT_NUMBER",
                                    "metricDisplayTrend": "METRIC_DISPLAY_TREND_ABSOLUTE_VALUE",
                                    "metricTrendType": "METRIC_TREND_TYPE_REGULAR"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "44ca3697349bad2f44aa0faa646bd0bcdb97f3070416df62576b27770c3919e4"
                },
                {
                    "name": "b708a9d3-6e6a-4357-8149-5dc3a9418625",
                    "displayName": "Top 20 Monitoring DNS Query Types by AVG time",
                    "description": "Long DNS query response times may indicate network congestion, server performance issues, or potential security threats. Timely analysis is crucial for maintaining optimal network performance and security. Investigate extended response times by examining server configurations, network traffic, and potential external attacks.",
                    "chartDatasource": {
                        "dashboardQuery": "2c85f4ff-c25d-46e4-b69e-df60fa8a2fec",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "network.dns.questions.name",
                                "header": "Query"
                            },
                            {
                                "field": "target.ip",
                                "header": "Responder"
                            },
                            {
                                "field": "avg_rtt",
                                "header": "Avg. Response Time (ms)"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "b8e98a528ee7a65fe507616755b26ac06858b3c9a84fab1b6b077070d6b6867b"
                },
                {
                    "name": "de820be7-1cce-4573-8777-8e5ef6237dac",
                    "displayName": "Network Evidence for Failed DNS Queries",
                    "chartDatasource": {
                        "dashboardQuery": "fb2888e3-2c84-4ece-8ef9-0c506ad1f581",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "rcode_name",
                                "header": "Response"
                            },
                            {
                                "field": "Source",
                                "header": "Source"
                            },
                            {
                                "field": "Responder",
                                "header": "Responder"
                            },
                            {
                                "field": "Query",
                                "header": "Query"
                            },
                            {
                                "field": "count",
                                "header": "Count"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "3a70f7a265ff6b1d6b6e9f21078a0fa015947444a365a24b370fde99fade602a"
                },
                {
                    "name": "17f692da-face-4197-aaa2-6e331742ccc4",
                    "displayName": " NXDOMAIN Responses",
                    "description": "High rates of DNS NXDOMAIN responses might suggest misconfigured domains, typographical errors in network requests, or malicious activities such as DNS reconnaissance. Close examination is advised to correct configurations or identify security incidents. Review DNS logs for patterns, validate domain configurations, and check endpoint security for signs of malware.",
                    "chartDatasource": {
                        "dashboardQuery": "31461062-5236-423b-810f-cf067fc34651",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "TEXT",
                                "label": " ",
                                "field": "count",
                                "metricTrendConfig": {
                                    "metricFormat": "METRIC_FORMAT_NUMBER",
                                    "metricDisplayTrend": "METRIC_DISPLAY_TREND_ABSOLUTE_VALUE",
                                    "metricTrendType": "METRIC_TREND_TYPE_REGULAR"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "a54e663d0c59a9432320af11e76ae0908a8ba4f1e8f2bc1310c4cdc5c9f049b3"
                },
                {
                    "name": "7c70144c-803c-4ee2-9360-f2f73f6035e7",
                    "displayName": "DNS Servers actively Responding to Queries",
                    "chartDatasource": {
                        "dashboardQuery": "46e16834-d84b-4651-8e01-639ea9c86179",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "target.ip",
                                "header": "Destination IP"
                            },
                            {
                                "field": "queries",
                                "header": "Queries"
                            },
                            {
                                "field": "clients",
                                "header": "Clients"
                            },
                            {
                                "field": "Country",
                                "header": "Country"
                            },
                            {
                                "field": "Internal",
                                "header": "Internal"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "da0ecc09fdfb5228bde3091ccfb37b5c15a1e811dd5ac268b902ab741c30adfd"
                },
                {
                    "name": "b81b89ce-a79a-43e2-827a-f42bfefd0604",
                    "displayName": "Unusual Query Types Found",
                    "chartDatasource": {
                        "dashboardQuery": "990be60d-0081-4477-9dd7-cb55b726b9b5",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "columnDefs": [
                            {
                                "field": "qtype_name",
                                "header": "Qtype "
                            },
                            {
                                "field": "target.ip",
                                "header": "Responder"
                            },
                            {
                                "field": "Source",
                                "header": "Source"
                            },
                            {
                                "field": "Query",
                                "header": "Query"
                            },
                            {
                                "field": "count",
                                "header": "Count"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "adefcb093fee6e18864ca0efafc0d66598e6ae7496946041ba2a8a23fe4a381c"
                },
                {
                    "name": "f55ea4eb-36c6-40cd-8c4b-0ed1125a007b",
                    "displayName": "Failed DNS Queries",
                    "description": "Failed DNS queries may point to misconfigurations, outdated systems, or security threats such as network infiltration or DNS poisoning. Analysts should investigate the sources and patterns of these failures to identify and remediate underlying causes, thereby ensuring network integrity and security.",
                    "chartDatasource": {
                        "dashboardQuery": "f31375be-00f7-446f-be61-04d0a9502591",
                        "dataSources": [
                            "UDM"
                        ]
                    },
                    "visualization": {
                        "series": [
                            {
                                "seriesType": "TEXT",
                                "label": " ",
                                "field": "count",
                                "metricTrendConfig": {
                                    "metricFormat": "METRIC_FORMAT_NUMBER",
                                    "metricDisplayTrend": "METRIC_DISPLAY_TREND_ABSOLUTE_VALUE",
                                    "metricTrendType": "METRIC_TREND_TYPE_REGULAR"
                                }
                            }
                        ],
                        "xAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "yAxes": [
                            {
                                "axisType": "VALUE"
                            }
                        ],
                        "legends": [
                            {
                                "legendOrient": "HORIZONTAL"
                            }
                        ],
                        "groupingType": "Off"
                    },
                    "tileType": "TILE_TYPE_VISUALIZATION",
                    "etag": "6c2140645add6640bd0ce8ec22e5ca02761d7fbae26de6c438b5849ffcb7d150"
                }
            ],
            "dashboardQueries": [
                {
                    "name": "fb2888e3-2c84-4ece-8ef9-0c506ad1f581",
                    "query": "metadata.vendor_name = \"Corelight\"\r\nmetadata.product_event_type = \"dns\"\r\n\r\nabout.labels[\"rcode_name\"] = \"SERVFAIL\" OR about.labels[\"rcode_name\"] = \"REFUSED\" OR about.labels[\"rcode_name\"] = \"FORMERR\" OR about.labels[\"rcode_name\"] = \"NOTIMP\" OR about.labels[\"rcode_name\"] = \"NOTAUTH\"\r\n\r\n$rcode_name = about.labels[\"rcode_name\"]\r\n\r\nmatch:\r\n    $rcode_name\r\n\r\noutcome:\r\n    $Source = window.last(metadata.event_timestamp.seconds, principal.ip)\r\n    $Responder = window.last(metadata.event_timestamp.seconds, target.ip)\r\n    $Query = window.last(metadata.event_timestamp.seconds, network.dns.questions.name)\r\n    $count=count_distinct(metadata.id)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "23d63f83868d40760ec762ff9a85c4e51455f178c58d50e18491548ffb40d65e"
                },
                {
                    "name": "31461062-5236-423b-810f-cf067fc34651",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type=\"dns\"\r\n\r\nabout.labels[\"rcode_name\"]=\"NXDOMAIN\" OR about.labels[\"rcode_name\"]=\"NOERROR\"\r\n\r\n$query_rejected = if(about.labels[\"rejected\"]=\"true\", \"Yes\", \"No\")\r\n\r\noutcome:\r\n    $count=count_distinct(metadata.id)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "33365c89dee22bd1a8b4c4fa9a2aa5e78eb1c3f236501a8c061f9b1e8ae77395"
                },
                {
                    "name": "46e16834-d84b-4651-8e01-639ea9c86179",
                    "query": "metadata.vendor_name = \"Corelight\"\r\nmetadata.product_event_type = \"dns\"\r\ntarget.ip!=\"\"\r\n$country = if(target.ip_geo_artifact.location.country_or_region!=\"\", target.ip_geo_artifact.location.country_or_region, \"Unknown\")\r\n\r\n$internal=if(target.ip in cidr %internal_cidr_list, \"Yes\", \"No\")\r\n\r\nmatch:\r\n    target.ip\r\n\r\noutcome:\r\n    $queries=count(network.dns.questions.name)\r\n    $clients=count_distinct(principal.ip)\r\n    $Country=array_distinct($country)\r\n    $Internal=array_distinct($internal)\r\n\r\norder:\r\n    $queries desc, $clients desc",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "f07048e9e869bbe21f78c4767cc603ad86b17003e1b1f3908d46d5d75001cb83"
                },
                {
                    "name": "5169a7c2-d75a-426e-9194-77b296d471f1",
                    "query": "metadata.vendor_name=\"Corelight\"\r\nmetadata.product_event_type=\"dns\"\r\n\r\nabout.labels[\"rcode_name\"]=\"NXDOMAIN\" OR about.labels[\"rcode_name\"]=\"NOERROR\"\r\n\r\n$query_rejected = if(about.labels[\"rejected\"]=\"true\", \"Yes\", \"No\")\r\n\r\nmatch:\r\n    principal.ip, target.ip, network.dns.questions.name, $query_rejected\r\n\r\noutcome:\r\n    $count=count_distinct(metadata.id)\r\norder:\r\n    $count desc",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "1aa57f304bf0a6dde9eac4ef805f148f9a7e2cc3d8fddce53bba2c40728ae7b2"
                },
                {
                    "name": "db46fcd3-8323-4b75-afcc-458ed2d17956",
                    "query": "metadata.vendor_name = \"Corelight\"\r\nmetadata.product_event_type = \"conn\"\r\n\r\nnetwork.application_protocol = \"DNS\"\r\n\r\noutcome:\r\n    $total_traffic = if(sum(network.sent_bytes) >= (1024*1024*1024*1024), strings.concat(math.round(sum(network.sent_bytes) / (1024*1024*1024*1024), 2), \" TB\"), \r\n    if(sum(network.sent_bytes) >= (1024*1024*1024), strings.concat(math.round(sum(network.sent_bytes) / (1024*1024*1024), 2), \" TB\"), \r\n    if(sum(network.sent_bytes) >= (1024*1024), strings.concat(math.round(sum(network.sent_bytes) / (1024*1024), 2), \" MB\"), \r\n    if(sum(network.sent_bytes) >= 1024, strings.concat(math.round(sum(network.sent_bytes) / (1024*1024*1024), 2), \" KB\"), \"0 B\" ))))",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "0e1aea6cb0ff33b0f405ebf25ff4b9114f3a16e5d32a88f5eb7a6708d6234e85"
                },
                {
                    "name": "f31375be-00f7-446f-be61-04d0a9502591",
                    "query": "metadata.vendor_name = \"Corelight\"\r\nmetadata.product_event_type = \"dns\"\r\n\r\nabout.labels[\"rcode_name\"] = \"SERVFAIL\" OR about.labels[\"rcode_name\"] = \"REFUSED\" OR about.labels[\"rcode_name\"] = \"FORMERR\" OR about.labels[\"rcode_name\"] = \"NOTIMP\" OR about.labels[\"rcode_name\"] = \"NOTAUTH\"\r\n\r\noutcome:\r\n    $count=count_distinct(metadata.id)",
                    "input": {
                        "timeWindow": {
                            "startTime": "2025-03-25T00:00:00Z",
                            "endTime": "2025-03-25T23:59:59Z"
                        }
                    },
                    "etag": "1796aa1b7f8557acffe50a72dc623160928abab347834920b93445f32c51d68b"
                },
                {
                    "name": "20a06dc7-93f1-4bb9-820d-eebfb152eb2a",
                    "query": "metadata.vendor_name = \"Corelight\"\r\nmetadata.product_event_type = \"dns\"\r\n\r\n$date_hour=timestamp.get_timestamp(metadata.event_timestamp.seconds, \"%Y-%m-%d : %H\")\r\nmatch:\r\n    $date_hour\r\noutcome:\r\n    $count = count_distinct(metadata.id)\r\norder:\r\n    $date_hour asc",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "9edc5001bfa508dabed48f72015fa815c66278c3089484e21f1cac1636da7e29"
                },
                {
                    "name": "b519b4cd-989e-4862-a7d9-264e7b27d042",
                    "query": "metadata.vendor_name = \"Corelight\"\r\nmetadata.product_event_type = \"dns\"\r\ntarget.ip!=\"\"\r\n\r\noutcome:\r\n    $count=count_distinct(target.ip)",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "20d6581ccae29b8e96863e97a85208d5f35242ecf5a514bc529fe1816040f647"
                },
                {
                    "name": "990be60d-0081-4477-9dd7-cb55b726b9b5",
                    "query": "metadata.vendor_name = \"Corelight\"\r\nmetadata.product_event_type = \"dns\"\r\n\r\nabout.labels[\"qtype_name\"]=\"AXFR\" OR about.labels[\"qtype_name\"]=\"IXFR\" OR about.labels[\"qtype_name\"]=\"ANY\" OR about.labels[\"qtype_name\"]=\"TXT\"\r\n$qtype_name = about.labels[\"qtype_name\"]\r\n\r\nmatch:\r\n    $qtype_name, target.ip\r\n\r\noutcome:\r\n    $Source = window.last(metadata.event_timestamp.seconds, principal.ip)\r\n    $Query = window.last(metadata.event_timestamp.seconds, network.dns.questions.name)\r\n    $count=count_distinct(metadata.id)\r\n\r\norder:\r\n    $count desc",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "20"
                        }
                    },
                    "etag": "ff851425953dbf021625832f547e59521e0383c34d3466778be6cbe542f62574"
                },
                {
                    "name": "2c85f4ff-c25d-46e4-b69e-df60fa8a2fec",
                    "query": "metadata.vendor_name = \"Corelight\"\r\nmetadata.product_event_type = \"dns\"\r\n\r\nmatch: \r\n    network.dns.questions.name, target.ip\r\n\r\noutcome:\r\n    $avg_rtt = math.round(avg(network.session_duration.seconds)*1000, 2)\r\n\r\norder:\r\n    $avg_rtt desc \r\nlimit:\r\n    20",
                    "input": {
                        "relativeTime": {
                            "timeUnit": "DAY",
                            "startTimeVal": "1"
                        }
                    },
                    "etag": "ac32195cc0ac5df4dc51f488767f6c1de313c2be5d9bf96005bf26475c33f8c4"
                },
                {
                    "name": "8fcba1cf-22d3-4079-b57d-ac616aabff3e",
                    "query": "metadata.vendor_name = \"Corelight\"\r\nmetadata.product_event_type = \"dns\"\r\nabout.labels[\"qtype_name\"]=\"AXFR\" OR about.labels[\"qtype_name\"]=\"IXFR\" OR about.labels[\"qtype_name\"]=\"ANY\" OR about.labels[\"qtype_name\"]=\"TXT\"\r\n\r\noutcome:\r\n    $count=count_distinct(metadata.id)",
                    "input": {
                        "timeWindow": {
                            "startTime": "2025-03-11T00:00:00Z",
                            "endTime": "2025-03-12T00:00:00Z"
                        }
                    },
                    "etag": "fae9c57a170ca41ea924d9c9f8267da35dfc0326c9844a2389d67cc2e528d685"
                }
            ]
        }
    ]
}